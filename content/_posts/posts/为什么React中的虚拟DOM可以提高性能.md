---
title: "理解React中的虚拟DOM"
date: 2020-02-02T15:46:42+08:00
draft: false
tags:
  - "React"
---

<!--more-->

React 在组件中维护了一套映射真实 DOM 的虚拟 DOM 状态。当组件发生变化时，他不会直接操作真实 DOM，而会先和旧的虚拟 DOM 进行一个 Diff 操作，得到需要改变的 DOM 节点后，再去改变需要改变的节点。

比较两个树直接的差异的算法的时间复杂度本来是 O(n^3) 级别的。如果 React 也采用这个方法的话，那无疑对性能来说是个很大的考验。

鉴于 UI 中 DOM 节点的结构相对稳定，React 的 Diff 算法的时间复杂度降到了 O(n)。那它是咋做的呢？我们可以把 UI 组件的变化分为三种情况：

1. 属性、顺序发生变化，这时候 React 只会改变 DOM 节点的属性或者给他们互换位置。

2. 节点类型发生变化，此时会直接重新渲染。

3. 节点跨层移动，也会重新渲染。

或许看起来很浪费性能，但实际上在特殊的 UI 场景下，它确实是很高效的。当然了它还有一个前提，就是我们要给类型相同的兄弟节点一个 key ,让它可以被唯一标识。
